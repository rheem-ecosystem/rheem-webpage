<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">









<title>Download</title>

<meta name="generator" content="Hugo 0.46" />


<link rel="stylesheet" href="http://da.qcri.org/rheem/css/owl.carousel.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/bootstrap.min.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/font-awesome.min.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/airspace-local-fonts.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/airspace.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/style.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/ionicons.min.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/animate.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/responsive.css" />
<link rel="stylesheet" href="http://da.qcri.org/rheem/css/syntax.css" />

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="http://da.qcri.org/rheem/js/bootstrap.min.js"></script>
<script src="http://da.qcri.org/rheem/js/owl.carousel.min.js"></script>
<script src="http://da.qcri.org/rheem/js/plugins.js"></script>
<script src="http://da.qcri.org/rheem/js/min/waypoints.min.js"></script>
<script src="http://da.qcri.org/rheem/js/jquery.counterup.js"></script>


<script src="http://da.qcri.org/rheem/js/main.js"></script>

<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-124750019-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-124750019-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



	<link rel="stylesheet" href="http://da.qcri.org/rheem/css/styles/darkula.css">
	<script src="http://da.qcri.org/rheem/js/highlight.pack.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.3.0/highlightjs-line-numbers.min.js"></script>
	<script>hljs.initHighlightingOnLoad();hljs.initLineNumbersOnLoad();</script>
</head>
<body>

	
<header>
  <a href="https://github.com/rheem-ecosystem/rheem"><img style="position: absolute; top: 0; left: 0; border: 0; z-index: 12; " src="https://camo.githubusercontent.com/121cd7cbdc3e4855075ea8b558508b91ac463ac2/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_green_007200.png"></a>

  <div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://da.qcri.org/rheem/">
              <img src="http://da.qcri.org/rheem/img/logo.png" alt="Rheem X-Platform Logo" class="logo-rheem">
            </a>
          </div>
            
            <div class="collapse navbar-collapse move" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav navbar-right">
                <li><a href="http://da.qcri.org/rheem/">Home</a></li>
              
                <li><a href="/rheem/about/">About</a></li>
              
                <li><a href="/rheem/documentation/">Documentation</a></li>
              
                <li><a href="/rheem/publication/">Publications</a></li>
              
                <li><a href="/rheem/people/">People</a></li>
              
                <li><a href="/rheem/download/">Download</a></li>
              
                <li><a href="/rheem/contact/">Contact</a></li>
              
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </div>
</header>

	
	
		
<section class="global-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h1>Download</h1>
                    <p></p>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="download">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <p>
                    Rheem is an efficient and scalable data processing framework developed by the data analytics group at Qatar
                    Computing Research Institute in collaboration with the information systems group at the Hasso Plattner Institute.
                    In contrast to classical data processing systems that provide one dedicated execution engine, Rheem rather
                    is a meta processing framework: You can specify your data processing app via one of Rheem's API and then
                    Rheem will pick an optimal configuration of classical processing frameworks, such as Java Streams or
                    Apache Spark, to run your app on. Finally, Rheem will also perform the execution, thereby hiding the
                    different specific platform APIs and coordinate inter-platform communication.
                </p>
                <p>
                    This approach aims at freeing data engineers and software developers from the burden of knowing the zoo of
                    different data processing systems, their APIs, strengths and weakness; the intricacies of coordinating and
                    integrating different processing platforms; and the inflexibility when tying to a fix set of processing
                    platforms. As of now, Rheem has built in support for the following processing platforms:
                    <ul style="margin-left: 3em; list-style-type:disc">
                        <li>Java 8 Streams</li>
                        <li>Apache Spark</li>
                        <li>GraphChi</li>
                        <li>Postgres</li>
                        <li>SQLite</li>
                    </ul>
                </p>
                <hr>
                <p>
                    Rheem is open source. You can find the source code in <a href="https://github.com/rheem-ecosystem/rheem"><i class="fa fa-github"></i>/rheem-ecosystem/rheem</a>
                </p>
            </div>
        </div>
    </div>
</section>
<section class="global-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h1>How to use Rheem</h1>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="how_use">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <br>
                <div class="alert alert-warning">
                    <h2>Requirements</h2>
                    Rheem is built with Java 8 and Scala 2.11. However, to execute Rheem it is sufficient to have Java 8 installed. If you want to build Rheem yourself, you will also need to have Apache Maven installed. Please also consider that processing platforms employed by Rheem might have further requirements.
                </div>
                <br>
                <div class="alert alert-info">
                    <h2>Get Rheem</h2>
                    Rheem is available via Maven Central. To use it with Maven, for instance, include the following into you POM file:
                    <pre><code class="html">
&#x3C;dependency&#x3E;&#x2028;
    &#x3C;groupId&#x3E;org.qcri.rheem&#x3C;/groupId&#x3E;
    &#x3C;artifactId&#x3E;rheem-***&#x3C;/artifactId&#x3E;
    &#x3C;version&#x3E;0.2.0&#x3C;/version&#x3E;&#x2028;
&#x3C;/dependency&#x3E;
                        </code></pre>
                </div>
                <div>
                    <strong>Note the</strong>
                    <pre><code>&#x3C;artifactId&#x3E;rheem-***&#x3C;/artifactId&#x3E;</code></pre>
                    Rheem ships with multiple modules that can be included in your app, depending on how you want to use it:
                    <table class="table table-condensed table-bordered">
                        <thead>
                            <tr>
                                <th>Module</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="danger">
                                <th>rheem-core</th>
                                <td>provides core data structures and the optimizer (required)</td>
                            </tr>
                            <tr class="warning">
                                <th>rheem-basic</th>
                                <td>provides common operators and data types for your apps (recommended)</td>
                            </tr>
                            <tr class="warning">
                                <th>rheem-api</th>
                                <td>provides an easy-to-use Scala and Java API to assemble Rheem plans (recommended)</td>
                            </tr>
                            <tr>
                                <th>rheem-java</th>
                                <td>Implementation of the operator for platform Java 8 Stream</td>
                            </tr>
                            <tr>
                                <th>rheem-spark_2.11</th>
                                <td>Implementation of the operator for platform Apache Spark but the version of scala 2.11</td>
                            </tr>
                            <tr>
                                <th>rheem-graphchi</th>
                                <td>Implementation of the operator for platform graphchi</td>
                            </tr>
                            <tr>
                                <th>rheem-sqlite3</th>
                                <td>Implementation of the operator for platform sqlite3</td>
                            </tr>
                            <tr>
                                <th>rheem-postgres</th>
                                <td>Implementation of the operator for platform postgres</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="alert alert-danger">
                    <h2>Don't Forget!!</h2>
                    For the sake of version flexibility, you still have to include your Hadoop and Spark version of choice.
                    <ul style="margin-left: 3em; list-style-type:disc"s>
                        <li>hadoop-hdfs</li>
                        <li>hadoop-common</li>
                        <li>spark-core</li>
                        <li>spark-graphx</li>
                    </ul>
                </div>
                <div class="alert alert-success">
                    <h2>If you want</h2>
                    In addition, you can obtain the most recent snapshot version of Rheem via Sonatype's snapshot repository. Just included
                    <pre><code class="xml">&#x3C;repositories&#x3E;
  &#x3C;repository&#x3E;
    &#x3C;id&#x3E;sonatype-snapshots&#x3C;/id&#x3E;
    &#x3C;name&#x3E;Sonatype Snapshot Repository&#x3C;/name&#x3E;
    &#x3C;url&#x3E;https://oss.sonatype.org/content/repositories/snapshots&#x3C;/url&#x3E;
  &#x3C;/repository&#x3E;
&#x3C;repositories&#x3E;
                    </code></pre>
                </div>
                <div class="alert alert-success">
                    <h2>If you need</h2>
                    If you need to rebuild Rheem, e.g., to use a different Scala version, you can simply do so via Maven:
                    <pre><code class="bash">$ mvn clean install</code></pre>
                </div>
                <div class="alert alert-danger">
                    <h2>Don't Forget!!</h2>
                    Configure Rheem. In order for Rheem to work properly, it is necessary to tell Rheem about the capacities of
                    your processing platforms and how to reach them. While there is a default configuration that allows to
                    test Rheem right away, we recommend to create a properties file to adapt the configuration where necessary.
                    To have Rheem use that configuration transparently, just run you app via
                    <pre><code class="bash">$ java -Drheem.properties=url://to/my/rheem.properties ...</code></pre>
                    <br>
                    You can find the most relevant settings in the following:
                    <table class="table table-bordered table-condensed" style="color:black !important; background-color: white; ">
                        <thead>
                            <tr class="active">
                                <th style="width: 10%">Module</th>
                                <th style="width: 20%">Name</th>
                                <th style="width: 20%">Default value</th>
                                <th style="width: 50%">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="active">
                                <td>General</td>
                                <td>rheem.core.log.enabled</td>
                                <td>true</td>
                                <td>whether to log execution statistics to allow learning better cardinality and cost estimators for the optimizer</td>
                            </tr>
                            <tr class="active">
                                <td>General</td>
                                <td>rheem.core.log.executions</td>
                                <td>~/.rheem/executions.json></td>
                                <td>where to log execution times of operator groups</td>
                            </tr>
                            <tr class="active">
                                <td>General</td>
                                <td>rheem.core.log.cardinalities</td>
                                <td>~/.rheem/cardinalities.json</td>
                                <td>where to log cardinality measurements</td>
                            </tr>
                            <tr class="active">
                                <td>General</td>
                                <td>rheem.core .optimizer.instrumentation</td>
                                <td>org.qcri.rheem.core .profiling .OutboundInstrumentationStrategy</td>
                                <td>where to measure cardinalities in Rheem plans; other options are
                                    org.qcri.rheem.core.profiling.NoInstrumentationStrategy
                                    and
                                    org.qcri.rheem.core.profiling.FullInstrumentationStrategy
                                </td>
                            </tr>
                            <tr class="active">
                                <td>General</td>
                                <td>rheem.core.optimizer.reoptimize</td>
                                <td>false</td>
                                <td>whether to progressively optimize Rheem plans</td>
                            </tr>
                            <tr class="active">
                                <td>General</td>
                                <td>rheem.basic.tempdir</td>
                                <td>file:///tmp</td>
                                <td>where to store temporary files, in particular for inter-platform communication</td>
                            </tr>
                            <tr class="active">
                                <td>Java Streams</td>
                                <td>rheem.java.cpu.mhz</td>
                                <td>2700</td>
                                <td>clock frequency of processor the JVM runs on in MHz</td>
                            </tr>
                            <tr class="active">
                                <td>Java Streams</td>
                                <td>heem.java.hdfs.ms-per-mb</td>
                                <td>2.7</td>
                                <td>average throughput from HDFS to JVM in ms/MB</td>
                            </tr>
                            <tr class="active">
                                <td>Apache Spark </td>
                                <td>spark.master</td>
                                <td>local</td>
                                <td>Host of Spark master</td>
                            </tr>
                            <tr class="active">
                                <td>Apache Spark </td>
                                <td>rheem.spark.cpu.mhz</td>
                                <td>2700</td>
                                <td>clock frequency of processor the Spark workers run on in MHz</td>
                            </tr>
                            <tr class="active">
                                <td>Apache Spark </td>
                                <td>rheem.spark.hdfs.ms-per-mb</td>
                                <td>2.7</td>
                                <td>average throughput from HDFS to the Spark workers in ms/MB</td>
                            </tr>
                            <tr class="active">
                                <td>Apache Spark </td>
                                <td>rheem.spark.network.ms-per-mb</td>
                                <td>8.6</td>
                                <td>average network throughput of the Spark workers in ms/MB</td>
                            </tr>
                            <tr class="active">
                                <td>Apache Spark </td>
                                <td>rheem.spark.init.ms</td>
                                <td>4500</td>
                                <td>time it takes Spark to initialize in ms</td>
                            </tr>
                            <tr class="active">
                                <td>Apache Spark </td>
                                <td>spark.**</td>
                                <td>Depends of your configuration of spark</td>
                                <td>Here you can put all the configuration of your spark </td>
                            </tr>
                            <tr class="active">
                                <td>GraphChi</td>
                                <td>rheem.graphchi.cpu.mhz</td>
                                <td>2700</td>
                                <td>clock frequency of processor GraphChi runs on in MHz</td>
                            </tr>
                            <tr class="active">
                                <td>GraphChi</td>
                                <td>rheem.graphchi.cpu.cores</td>
                                <td>2</td>
                                <td>number of cores GraphChi runs on</td>
                            </tr>
                            <tr class="active">
                                <td>GraphChi</td>
                                <td>rheem.graphchi.hdfs.ms-per-mb</td>
                                <td>2.7</td>
                                <td>average throughput from HDFS to GraphChi in ms/MB</td>
                            </tr>
                            <tr class="active">
                                <td>SQLite</td>
                                <td>rheem.sqlite3.jdbc.url</td>
                                <td></td>
                                <td>JDBC URL to use SQLite</td>
                            </tr>
                            <tr class="active">
                                <td>SQLite</td>
                                <td>rheem.sqlite3.cpu.mhz</td>
                                <td>2700</td>
                                <td>clock frequency of processor SQLite runs on in MHz</td>
                            </tr>
                            <tr class="active">
                                <td>SQLite</td>
                                <td>rheem.sqlite3.cpu.cores</td>
                                <td>2</td>
                                <td>number of cores SQLite runs on</td>
                            </tr>
                            <tr class="active">
                                <td>PostgreSQL</td>
                                <td>rheem.postgres.jdbc.url</td>
                                <td></td>
                                <td>JDBC URL to use PostgreSQL</td>
                            </tr>
                            <tr class="active">
                                <td>PostgreSQL</td>
                                <td>rheem.postgres.cpu.mhz</td>
                                <td>2700</td>
                                <td>clock frequency of processor PostgreSQL runs on in MHz</td>
                            </tr>
                            <tr class="active">
                                <td>PostgreSQL</td>
                                <td>rheem.postgres.cpu.cores </td>
                                <td>2</td>
                                <td>number of cores PostgreSQL runs on</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</section>
<section class="global-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h1>Coding with Rheem</h1>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="code">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <br>
                <div class="alert alert-info">
                    <h2>Recomendation </h2>
                    The recommended way to specify your apps with Rheem is via its Scala or Java API from the
                    <strong>rheem-api</strong>
                    module. You can find examples below.
                </div>
                <h2>Examples</h2>

                For some executable examples, have a look at this <a href="https://github.com/sekruse/rheem-examples"><i class="fa fa-github-square"></i>/sekruse/rheem-examples</a>.
                <hr>
                <h3>WordCount</h3>
                The "Hello World!" of data processing systems is the wordcount.

                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#javaapi1" aria-controls="javaapi1" role="tab" data-toggle="tab">Java API</a></li>
                    <li role="presentation"><a href="#scalaapi1" aria-controls="scalaapi1" role="tab" data-toggle="tab">Scala API</a></li>
                </ul>
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="javaapi1">
                        <pre><code class="java">import org.qcri.rheem.api.JavaPlanBuilder;
import org.qcri.rheem.basic.data.Tuple2;
import org.qcri.rheem.core.api.Configuration;
import org.qcri.rheem.core.api.RheemContext;
import org.qcri.rheem.core.optimizer.ProbabilisticDoubleInterval;
import org.qcri.rheem.core.optimizer.cardinality.DefaultCardinalityEstimator;
import org.qcri.rheem.core.plugin.Plugin;
import org.qcri.rheem.java.Java;
import org.qcri.rheem.spark.Spark;
import java.util.Collection;
import java.util.Arrays;

// Settings
String inputUrl = &#x22;hdfs://my/file.txt&#x22;;

// Get a plan builder.
RheemContext rheemContext = new RheemContext(new Configuration())
    .withPlugin(Java.basicPlugin())
    .withPlugin(Spark.basicPlugin());
JavaPlanBuilder planBuilder = new JavaPlanBuilder(rheemContext)
    .withJobName(String.format(&#x22;WordCount (%s)&#x22;, inputUrl))
    .withUdfJarOf(this.getClass());

// Start building the RheemPlan.
Collection&#x3C;Tuple2&#x3C;String, Integer&#x3E;&#x3E; wordcounts = planBuilder
    // Read the text file.
    .readTextFile(inputUrl).withName(&#x22;Load file&#x22;)

    // Split each line by non-word characters.
    .flatMap(line -&#x3E; Arrays.asList(line.split(&#x22;\\W+&#x22;)))
    .withSelectivity(10, 100, 0.9)
    .withName(&#x22;Split words&#x22;)

    // Filter empty tokens.
    .filter(token -&#x3E; !token.isEmpty())
    .withSelectivity(0.99, 0.99, 0.99)
    .withName(&#x22;Filter empty words&#x22;)

    // Attach counter to each word.
    .map(word -&#x3E; new Tuple2&#x3C;&#x3E;(word.toLowerCase(), 1)).withName(&#x22;To lower case, add counter&#x22;)

    // Sum up counters for every word.
    .reduceByKey(
            Tuple2::getField0,
            (t1, t2) -&#x3E; new Tuple2&#x3C;&#x3E;(t1.getField0(), t1.getField1() + t2.getField1())
    )
    .withCardinalityEstimator(new DefaultCardinalityEstimator(0.9, 1, false, in -&#x3E; Math.round(0.01 * in[0])))
    .withName(&#x22;Add counters&#x22;)

    // Execute the plan and collect the results.
    .collect();</code></pre>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="scalaapi1">
                        <pre><code class="scala">import org.qcri.rheem.api._
import org.qcri.rheem.core.api.{Configuration, RheemContext}
import org.qcri.rheem.java.Java
import org.qcri.rheem.spark.Spark

// Settings
val inputUrl = &#x22;hdfs://my/file.txt&#x22;

// Get a plan builder.
val rheemContext = new RheemContext(new Configuration)
    .withPlugin(Java.basicPlugin)
    .withPlugin(Spark.basicPlugin)
val planBuilder = new PlanBuilder(rheemContext)
    .withJobName(s&#x22;WordCount ($inputUrl)&#x22;)
    .withUdfJarsOf(this.getClass)

val wordcounts = planBuilder
    // Read the text file.
    .readTextFile(inputUrl).withName(&#x22;Load file&#x22;)

    // Split each line by non-word characters.
    .flatMap(_.split(&#x22;\\W+&#x22;), selectivity = 10).withName(&#x22;Split words&#x22;)

    // Filter empty tokens.
    .filter(_.nonEmpty, selectivity = 0.99).withName(&#x22;Filter empty words&#x22;)

    // Attach counter to each word.
    .map(word =&#x3E; (word.toLowerCase, 1)).withName(&#x22;To lower case, add counter&#x22;)

    // Sum up counters for every word.
    .reduceByKey(_._1, (c1, c2) =&#x3E; (c1._1, c1._2 + c2._2)).withName(&#x22;Add counters&#x22;)
    .withCardinalityEstimator((in: Long) =&#x3E; math.round(in * 0.01))

    // Execute the plan and collect the results.
    .collect()</code></pre>
                    </div>
                </div>
                <h3>k-means</h3>
                Rheem is also capable of iterative processing, which is, e.g., very important for machine learning algorithms, such as k-means.
                <ul class="nav nav-tabs" role="tablist">

                    <li role="presentation" class="active"><a href="#scalaapi2" aria-controls="scalaapi2" role="tab" data-toggle="tab">Scala API</a></li>
                </ul>
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane" id="javaapi2">
                        <pre><code class="java"></code></pre>
                    </div>
                    <div role="tabpanel" class="tab-pane active" id="scalaapi2">
                        <pre><code class="scala">import org.qcri.rheem.api._
import org.qcri.rheem.core.api.{Configuration, RheemContext}
import org.qcri.rheem.java.Java
import org.qcri.rheem.spark.Spark
import scala.util.Random
import scala.collections.JavaConversions._

// Settings
val inputUrl = &#x22;hdfs://my/file.txt&#x22;
val iterations = 20

// Get a plan builder.
val rheemContext = new RheemContext(new Configuration)
    .withPlugin(Java.basicPlugin)
    .withPlugin(Spark.basicPlugin)
val planBuilder = new PlanBuilder(rheemContext)
  .withJobName(s&#x22;k-means ($inputFile, k=$k, $iterations iterations)&#x22;)
  .withUdfJarsOf(this.getClass)

// Read and parse the input file(s).
val points = planBuilder
  .readTextFile(inputUrl).withName(&#x22;Read file&#x22;)
  .map { line =&#x3E;
    val fields = line.split(&#x22;,&#x22;)
    Point(fields(0).toDouble, fields(1).toDouble)
  }.withName(&#x22;Create points&#x22;)

case class Point(x: Double, y: Double)
case class TaggedPoint(x: Double, y: Double, cluster: Int)
case class TaggedPointCounter(x: Double, y: Double, cluster: Int, count: Long) {
  def +(that: TaggedPointCounter) = TaggedPointCounter(this.x + that.x, this.y + that.y, this.cluster, this.count + that.count)
  def average = TaggedPoint(x / count, y / count, cluster)
}

// Create initial centroids.
val random = new Random
val initialCentroids = planBuilder
  .loadCollection(for (i &#x3C;- 1 to n) yield TaggedPoint(random.nextGaussian(), random.nextGaussian(), i)).withName(&#x22;Load random centroids&#x22;)

// Declare UDF to select centroid for each data point.
class SelectNearestCentroid extends ExtendedSerializableFunction[Point, TaggedPoint] {

  /** Keeps the broadcasted centroids. */
  var centroids: Iterable[TaggedPoint] = _

  override def open(executionCtx: ExecutionContext) = {
    centroids = executionCtx.getBroadcast[TaggedPoint](&#x22;centroids&#x22;)
  }

  override def apply(point: Point): TaggedPointCounter = {
    var minDistance = Double.PositiveInfinity
    var nearestCentroidId = -1
    for (centroid &#x3C;- centroids) {
      val distance = point.distanceTo(centroid)
      if (distance &#x3C; minDistance) {
        minDistance = distance
        nearestCentroidId = centroid.centroidId
      }
    }
    new TaggedPointCounter(point.x, point.y, nearestCentroidId, 1)
  }
}

// Do the k-means loop.
val finalCentroids = initialCentroids.repeat(iterations, { currentCentroids =&#x3E;
  points
    .mapJava(
      new SelectNearestCentroid,
      udfCpuLoad = (in1: Long, in2: Long, out: Long) =&#x3E; in1 * in2 * 100L
    )
    .withBroadcast(currentCentroids, &#x22;centroids&#x22;).withName(&#x22;Find nearest centroid&#x22;)
    .reduceByKey(_.cluster, _ + _).withName(&#x22;Add up points&#x22;)
    .withCardinalityEstimator(k)
    .map(_.average).withName(&#x22;Average points&#x22;)
}).withName(&#x22;Loop&#x22;)

// Collect the results.
.collect()</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="global-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h1>Rheem in the Cluster</h1>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="cluster">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <br>
                <h2>Deploying and running a rheem application on the cluster.</h2>

                <ol>
                    <li>Create a RHEEM_HOME folder on the master node of your cluster.</li>
                    <li>Include rheem depedencies as shown above in your application's pom file.</li>
                    <li>Build your application with maven, and package its jars (including all rheem depedencies) into one folder, call it lib. You may need to use maven assembly plugin for that.</li>
                    <li>Copy the lib directory to your RHEEM_HOME </li>
                    <li>Copy the rheem.properties file to your RHEEM_HOME</li>
                    <li>Define a rheem classpath enviroment variable that has RHEEMHOME and SPARKHOME added</li>
                    <li>Run your application, pointing to rheem.properties and rheem classpath: java -Drheem.configuration="pathto/rheem.properties" -cp "$RHEEM_CLASSPATH" yourapplication.Main</li>
                </ol>

                <div class="alert alert-info">
                    <h2>Example</h2>
                    <a class="btn btn-default" href="https://s3.amazonaws.com/rheem-qcri/wordcount-distro.zip"><i class="fa fa-download"></i> Download </a>
                    <br>
                    The .zip has example of a distribution template of a word count application. conf/set-env.sh is a script for setting the class paths(step 6). bin/wordcount is a script for running the application (step 7). You can edit both files as needed, put all your jars under lib, and copy it directly to your cluster.
                </div>
            </div>
        </div>
    </div>
</section>
<section class="global-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h1>More Documentation</h1>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="more_documentation">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <br>
                <div class="alert alert-success">
                    <h2>Java Doc</h2>
                    You can find our Java Doc <a class="btn btn-default" href="http://da.qcri.org/rheem/rheem-resources/docs/index.html"><img src="http://da.qcri.org/rheem/img/java.png" style="width: 4.5em">doc</a>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="global-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h1>License</h1>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="licence">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <br>
                <p>
                    Unless explicitly stated otherwise all files in this repository are licensed under the Apache Software License 2.0
                </p>
                <p>
                    Copyright 2016 Qatar Computing Research Institute
                </p>
                <p>
                Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at
                </p>
                <pre><code class="bash">http://www.apache.org/licenses/LICENSE-2.0</code></pre>
                <p>
                    Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
                </p>
            </div>
        </div>
    </div>
</section>
	

	
		

<section id="call-to-action">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="block">
          <h2>Turning a Zoo into a Circus</h2>
          <p><a class="nothing" href="http://da.qcri.org/rheem/about">Read more</a> on how <b>RHEEM</b> tame the Zoo of existing data processing platforms to work together.</p>
          
        </div>
      </div>
    </div>
  </div>
</section>

	

	
<footer>
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="footer-manu">
          <ul>
            
            <li><a href="https://www.qcri.org/">About QCRI</a></li>
            
            <li><a href="/rheem/contact">Contact us</a></li>
            
            <li><a href="https://github.com/rheem-ecosystem">Fork me</a></li>
            
            <li><a href="https://github.com/rheem-ecosystem/rheem/blob/master/LICENSE.TXT">License</a></li>
            
          </ul>
        </div>
        <p>Copyright &copy; Developed by the dRHEEMers @ QCRI. All rights reserved.</p>
      </div>
    </div>
  </div>
</footer>


	
</body>
</html>